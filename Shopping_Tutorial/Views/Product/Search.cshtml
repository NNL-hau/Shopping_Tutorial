@using Shopping_Tutorial.Models.ViewModels
@model IEnumerable<ProductModel>
@{
    ViewData["Title"] = @ViewBag.Keyword;
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="col-sm-3">
    <partial name="_SidebarPartial" />
</div>

<div class="col-sm-9 padding-right">
    <div class="features_items">
        <!--features_items-->
        <h2 class="title text-center">@ViewBag.Keyword</h2>

        @foreach (var item in Model)
        {

			<div class="col-sm-4">
				<div class="product-image-wrapper">

					<div class="single-products">

						<div class="productinfo text-center">
							<a asp-action="Details" asp-controller="Product" asp-route-Id="@item.Id">
								<img src="~/images/@item.Image" alt="@item.Name" width="150" height="220" />
								<h2>@item.Price.ToString("#,##0 ") VNĐ</h2>

								<p>@item.Name</p>
								<p>Danh mục : @item.Category.Name</p>
								<p>Thương hiệu : @item.Brand.Name</p>
							</a>
							@if (item.Quantity > 0)
							{
								@* <a class="btn btn-default add-to-cart" asp-action="Add" asp-controller="Cart" asp-route-Id="@item.Id"><i class="fa fa-shopping-cart"></i>Thêm vào giỏ hàng</a> *@

								<button class="btn btn-default add-to-cart" data-product_id="@item.Id"><i class="fa fa-shopping-cart"></i>Thêm giỏ hàng</button>
							}
							else
							{
								<button class="btn btn-default "><i class="fa fa-shopping-cart"></i>Hết Hàng</button>
							}
						</div>
						<!--Phần hover-->
						<div class="product-overlay">
							<div class="overlay-content">
								<h2>@item.Price.ToString("#,##0 "),000 VNĐ</h2>
								<p>@item.Name</p>
								<a class="btn btn-default " asp-action="Details" asp-controller="Product" asp-route-Id="@item.Id"><i class="fa fa-address-card" aria-hidden="true"></i>Chi tiết sản phẩm</a>
								@* <a class="btn btn-default add-to-cart" asp-action="Add" asp-controller="Cart" asp-route-Id="@item.Id"><i class="fa fa-shopping-cart"></i>Thêm vào giỏ hàng</a> *@
								@if (item.Quantity > 0)
								{
									@* <a class="btn btn-default add-to-cart" asp-action="Add" asp-controller="Cart" asp-route-Id="@item.Id"><i class="fa fa-shopping-cart"></i>Thêm vào giỏ hàng</a> *@

									<button class="btn btn-default add-to-cart" data-product_id="@item.Id"><i class="fa fa-shopping-cart"></i>Thêm giỏ hàng</button>
								}
								else
								{
									<button class="btn btn-default "><i class="fa fa-shopping-cart"></i>Hết Hàng</button>
								}
							</div>
						</div>

					</div>

					<div class="choose">
						@if (User.Identity?.IsAuthenticated ?? false)
						{
							<ul class="nav nav-pills nav-justified">
								<li><button class="btn btn-danger add-btn-wishlist" data-product_id="@item.Id">Thêm Yêu Thích</button></li>
								<li><button class="btn btn-primary add-btn-compare" data-product_id="@item.Id">Thêm So Sánh</button></li>
							</ul>
						}
					</div>
				</div>
			</div>
        }

    </div><!--features_items-->



</div>
<style>
    .choose ul {
        padding: 0;
        margin-top: 10px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    h2.title.text-center {
        color: #3399FF;
    }


    .choose ul li {
        list-style: none;
        flex: 1;
        margin: 0 5px;
    }

    .choose button {
        width: 100%;
        padding: 10px;
        border: none;
        font-size: 14px;
        font-weight: bold;
        text-align: center;
        border-radius: 5px;
        transition: all 0.3s ease-in-out;
        cursor: pointer;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    /* Đổi màu từ vàng sang #3399FF */
    .add-btn-wishlist {
        background: #ff4d4d;
        color: white;
    }

        .add-btn-wishlist:hover {
            background: #cc0000;
        }
    /* Giá tiền trong sản phẩm và overlay */
    .productinfo h2,
    .product-overlay h2 {
        color: #3399FF;
    }

	.add-btn-compare {
		background-color: #3399FF !important;
		color: white !important;
		border: none !important;
	}

		.add-btn-compare:hover {
			background-color: #267ACC !important;
			color: white !important;
		}


    /* Nếu có dùng btn-warning từ Bootstrap, ghi đè màu vàng thành #3399FF */
    .btn-warning {
        background-color: #3399FF;
        border-color: #3399FF;
        color: black;
    }

    .product-overlay {
        background: linear-gradient(90deg, #fbc2eb, #a6c1ee) !important; /* nền xanh với độ mờ */
        color: black !important;
    }


        .product-overlay .overlay-content p,
        .product-overlay .overlay-content a,
        .product-overlay .overlay-content button {
            color: black !important;
        }

        .product-overlay .overlay-content h2 {
            color: white !important;
        }

        .product-overlay .overlay-content .btn-default {
            background-color: white;
            color: #3399FF;
            border: 1px solid #3399FF;
        }

            .product-overlay .overlay-content .btn-default:hover {
                background-color: #3399FF;
                color: white;
            }


    .btn-warning:hover {
        background-color: #267ACC;
        border-color: #267ACC;
    }
    /* Giá tiền trong sản phẩm và overlay */
    .productinfo h2,
    .product-overlay h2 {
        color: #3399FF;
    }

    /* Nền cho overlay: từ vàng → xanh */
    .product-overlay {
        background-color: rgba(51, 153, 255, 0.9); /* nền xanh nhạt */
        color: white;
    }

        /* Nút trong overlay */
        .product-overlay .btn {
            background-color: #3399FF;
            border: none;
            color: black !important;
            font-weight: bold;
        }

            .product-overlay .btn:hover {
                background-color: #267ACC;
                color: black; /* giữ màu chữ đen khi hover */
            }

        /* Nếu cần chỉnh thêm cho nội dung văn bản trong overlay */
        .product-overlay h2,
        .product-overlay p {
            color: white;
        }
</style>


@section Scripts {
	<script>
				$(document).ready(function() {
			$('.add-to-cart').click(function () {
				var Id = $(this).data("product_id");
				console.log("Product ID: " + Id); // Kiểm tra ID sản phẩm

				$.ajax({
					type: "POST",
					url: "@Url.Action("Add", "Cart")",
					data: { Id: Id },
					success: function (result) {
						if (result) {
							Swal.fire("Thêm giỏ hàng thành công.");
						} else {
							Swal.fire("Có lỗi xảy ra.");
						}
					},
					error: function (xhr, status, error) {
						console.error("Error: " + error); // Kiểm tra lỗi
						Swal.fire("Có lỗi xảy ra khi thêm vào giỏ hàng.");
					}
				});
			});
		});
	</script>
	<!---Add to Wishlish Script--->
	<script>
		$(document).ready(function () {
			$('.add-btn-wishlist').click(function () {
				var Id = $(this).data("product_id");

				//alert(product_id);

				$.ajax({
					type: "POST",
					url: "@Url.Action("AddWishlist", "Home")",
					data: { Id: Id }, // Send data to the server

					success: function (result) {
						// Handle successful update
						if (result) {

							Swal.fire("Bạn đã thêm sản phẩm vào danh sách yêu thích !.");
						}
					}

				});
			});
		});
	</script>
	<!---Add to Wishlish Script--->
	<script>
		$(document).ready(function () {
			$('.add-btn-compare').click(function () {
				var Id = $(this).data("product_id");

				//alert(product_id);

				$.ajax({
					type: "POST",
					url: "@Url.Action("AddCompare", "Home")",
					data: { Id: Id }, // Send data to the server

					success: function (result) {
						// Handle successful update
						if (result) {

							Swal.fire("Bạn đã thêm sản phẩm vào danh sách so sánh !.");
						}
					}

				});
			});
		});
	</script>
	<!---//Add to Wishlish Script--->
}
